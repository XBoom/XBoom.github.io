<!DOCTYPE html>
<html lang=en>
<head>
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?35ec0b872cf5aada9525fd9f0487c238";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>协议-04-DHCP | Yuan Kang</title>
  <meta name="description" content="**动态主机配置协议DHCP(Dynamic Host Configuration Protocol)是一种网络管理协议，用于集中对用户 IP 地址进行动态管理和配置。 DHCP协议由 RFC 2131 定义，采用 Client &#x2F;服务器通信模式，由客户端(DHCP Client)向服务器(DHCP Server)**提出配置申请，Server为网络上的每个设备动态分配 IP 地址、子网掩码、默认">
<meta property="og:type" content="article">
<meta property="og:title" content="协议-04-DHCP">
<meta property="og:url" content="http://xboom.github.io/2023/09/07/Protocol/%E5%8D%8F%E8%AE%AE-04-DHCP/index.html">
<meta property="og:site_name" content="XBoom Dove">
<meta property="og:description" content="**动态主机配置协议DHCP(Dynamic Host Configuration Protocol)是一种网络管理协议，用于集中对用户 IP 地址进行动态管理和配置。 DHCP协议由 RFC 2131 定义，采用 Client &#x2F;服务器通信模式，由客户端(DHCP Client)向服务器(DHCP Server)**提出配置申请，Server为网络上的每个设备动态分配 IP 地址、子网掩码、默认">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download-20230907220000104.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download-20230907220722271.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download-20230907220805159.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907230303654.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907230549875.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907230844722.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907231535947.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907231557794.png">
<meta property="article:published_time" content="2023-09-07T02:25:38.000Z">
<meta property="article:modified_time" content="2023-09-07T15:38:45.194Z">
<meta property="article:author" content="XBoom Dove">
<meta property="article:tag" content="DHCP">
<meta property="article:tag" content="Proto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download.png">
  <!-- Canonical links -->
  <link rel="canonical" href="http://xboom.github.io/2023/09/07/Protocol/%E5%8D%8F%E8%AE%AE-04-DHCP/index.html">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="XBoom Dove" type="application/atom+xml">
</head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/XBoom" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">Yuan Kang</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Learn and live</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">Repository</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/XBoom" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=728081687@qq.com" target="_blank" title="Email" data-toggle=tooltip data-placement=top><i class="icon icon-email"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>Keep on going never give up!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithms-To-Live-By/">Algorithms To Live By</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C++</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Design-Patterns/">Design Patterns</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-Transaction/">Distributed Transaction</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Grpc/">Grpc</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Interesting-Algorithm/">Interesting Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MQ/">MQ</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Microservices/">Microservices</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySql/">MySql</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Proto/">Proto</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Protocol/">Protocol</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP/IP</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithms-To-Live-By/" rel="tag">Algorithms To Live By</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Concurrency/" rel="tag">Concurrency</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DHCP/" rel="tag">DHCP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Design-Patterns/" rel="tag">Design Patterns</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Distributed-System/" rel="tag">Distributed System</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Distributed-Transaction/" rel="tag">Distributed Transaction</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ETCD/" rel="tag">ETCD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Event/" rel="tag">Event</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Go/" rel="tag">Go</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Grpc/" rel="tag">Grpc</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/" rel="tag">Kafka</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MQ/" rel="tag">MQ</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Memory/" rel="tag">Memory</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Microservices/" rel="tag">Microservices</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySql/" rel="tag">MySql</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PrimerPlus/" rel="tag">PrimerPlus</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Proto/" rel="tag">Proto</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quic/" rel="tag">Quic</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raft/" rel="tag">Raft</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/" rel="tag">TCP/IP</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a><span class="tag-list-count">5</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Algorithm/" style="font-size: 13.08px;">Algorithm</a> <a href="/tags/Algorithms-To-Live-By/" style="font-size: 13.42px;">Algorithms To Live By</a> <a href="/tags/C/" style="font-size: 13.83px;">C++</a> <a href="/tags/Concurrency/" style="font-size: 13px;">Concurrency</a> <a href="/tags/DHCP/" style="font-size: 13px;">DHCP</a> <a href="/tags/Design-Patterns/" style="font-size: 13.92px;">Design Patterns</a> <a href="/tags/Distributed-System/" style="font-size: 13px;">Distributed System</a> <a href="/tags/Distributed-Transaction/" style="font-size: 13.33px;">Distributed Transaction</a> <a href="/tags/Docker/" style="font-size: 13px;">Docker</a> <a href="/tags/ETCD/" style="font-size: 13px;">ETCD</a> <a href="/tags/Event/" style="font-size: 13px;">Event</a> <a href="/tags/Go/" style="font-size: 14px;">Go</a> <a href="/tags/Grpc/" style="font-size: 13.67px;">Grpc</a> <a href="/tags/HTTP/" style="font-size: 13px;">HTTP</a> <a href="/tags/Kafka/" style="font-size: 13.17px;">Kafka</a> <a href="/tags/Linux/" style="font-size: 13.25px;">Linux</a> <a href="/tags/MQ/" style="font-size: 13.25px;">MQ</a> <a href="/tags/Memory/" style="font-size: 13px;">Memory</a> <a href="/tags/Microservices/" style="font-size: 13.58px;">Microservices</a> <a href="/tags/MySql/" style="font-size: 13.5px;">MySql</a> <a href="/tags/PrimerPlus/" style="font-size: 13.75px;">PrimerPlus</a> <a href="/tags/Proto/" style="font-size: 13px;">Proto</a> <a href="/tags/Quic/" style="font-size: 13px;">Quic</a> <a href="/tags/Raft/" style="font-size: 13px;">Raft</a> <a href="/tags/Redis/" style="font-size: 13.67px;">Redis</a> <a href="/tags/TCP-IP/" style="font-size: 13.25px;">TCP/IP</a> <a href="/tags/k8s/" style="font-size: 13.25px;">k8s</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a><span class="archive-list-count">26</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Proto/">Proto</a>
              </p>
              <p class="item-title">
                <a href="/2023/09/07/Protocol/%E5%8D%8F%E8%AE%AE-04-DHCP/" class="title">协议-04-DHCP</a>
              </p>
              <p class="item-date">
                <time datetime="2023-09-07T02:25:38.000Z" itemprop="datePublished">2023-09-07</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Go/">Go</a>
              </p>
              <p class="item-title">
                <a href="/2023/07/15/Go/Go-27-SyncPool/" class="title">Go-27-SyncPool</a>
              </p>
              <p class="item-date">
                <time datetime="2023-07-15T05:32:45.000Z" itemprop="datePublished">2023-07-15</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Go/">Go</a>
              </p>
              <p class="item-title">
                <a href="/2023/07/13/Go/Go-26-Issue/" class="title">Go-26-Issue</a>
              </p>
              <p class="item-date">
                <time datetime="2023-07-13T14:59:45.000Z" itemprop="datePublished">2023-07-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Go/">Go</a>
              </p>
              <p class="item-title">
                <a href="/2023/07/01/Go/Go-25-PoolDequeue/" class="title">Go-25-PoolDequeue</a>
              </p>
              <p class="item-date">
                <time datetime="2023-07-01T08:51:45.000Z" itemprop="datePublished">2023-07-01</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Protocol/">Protocol</a>
              </p>
              <p class="item-title">
                <a href="/2023/06/26/Protocol/%E5%8D%8F%E8%AE%AE-03-Raft/" class="title">协议-03-Raft</a>
              </p>
              <p class="item-date">
                <time datetime="2023-06-26T02:25:38.000Z" itemprop="datePublished">2023-06-26</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
  <aside class="sidebar sidebar-toc collapse   in  " id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">Catalogue</h3>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp好处"><span class="toc-number">1.</span> <span class="toc-text"> DHCP好处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-工作原理"><span class="toc-number">2.</span> <span class="toc-text"> DHCP 工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#非中继"><span class="toc-number">2.1.</span> <span class="toc-text"> 非中继</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#中继"><span class="toc-number">2.2.</span> <span class="toc-text"> 中继</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#续租"><span class="toc-number">2.3.</span> <span class="toc-text"> 续租</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcp-报文"><span class="toc-number">3.</span> <span class="toc-text"> DHCP 报文</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#discover"><span class="toc-number">3.1.</span> <span class="toc-text"> Discover</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#offer"><span class="toc-number">3.2.</span> <span class="toc-text"> Offer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#request"><span class="toc-number">3.3.</span> <span class="toc-text"> Request</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ack"><span class="toc-number">3.4.</span> <span class="toc-text"> ACK</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dhcpv6"><span class="toc-number">4.</span> <span class="toc-text"> DHCPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考链接"><span class="toc-number">5.</span> <span class="toc-text"> 参考链接</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Protocol/协议-04-DHCP" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      协议-04-DHCP
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2023/09/07/Protocol/%E5%8D%8F%E8%AE%AE-04-DHCP/" class="article-date">
	  <time datetime="2023-09-07T02:25:38.000Z" itemprop="datePublished">2023-09-07</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Proto/">Proto</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/DHCP/" rel="tag">DHCP</a>, <a class="article-tag-link" href="/tags/Proto/" rel="tag">Proto</a>
  </span>


        

	<span class="article-read hidden-xs">
    	<i class="icon icon-eye-fill" aria-hidden="true"></i>
    	<span id="/2023/09/07/Protocol/%E5%8D%8F%E8%AE%AE-04-DHCP/" class="leancloud_visitors"  data-flag-title="协议-04-DHCP">0</span>
    </span>

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2023/09/07/Protocol/%E5%8D%8F%E8%AE%AE-04-DHCP/#comments" class="article-comment-link">Comments</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p>**动态主机配置协议<code>DHCP</code>(Dynamic Host Configuration Protocol)<strong>是一种网络管理协议，用于集中对用户 IP 地址进行动态管理和配置。<br />
<strong>DHCP协议</strong>由 <code>RFC 2131</code> 定义，采用 Client /服务器通信模式，由</strong>客户端(DHCP Client)<strong>向</strong>服务器(DHCP Server)**提出配置申请，<strong>Server</strong>为网络上的每个设备动态分配 <strong>IP 地址</strong>、<strong>子网掩码</strong>、<strong>默认网关地址</strong>，<strong>域名服务器(DNS)地址</strong>和其他相关配置参数，以便可以与其他IP网络通信</p>
<p>相关协议(按时间从远到近排序) <a href="http://www.ietf.org/rfc/rfc1531.txt" target="_blank" rel="noopener">RFC1531</a> 、<a href="http://www.ietf.org/rfc/rfc1541.txt" target="_blank" rel="noopener">RFC1541</a>、<a href="http://www.ietf.org/rfc/rfc2131.txt" target="_blank" rel="noopener">RFC2131</a> 、<a href="http://www.ietf.org/rfc/rfc3396.txt" target="_blank" rel="noopener">RFC3396</a></p>
<h3 id="dhcp好处"><a class="markdownIt-Anchor" href="#dhcp好处"></a> DHCP好处</h3>
<p>网络中，每个连接Internet的设备都需要分配唯一的 IP。DHCP 使网络管理员能<strong>从中心结点监控和分配IP地址</strong>，从以下几个方面降低了配置和部署设备的时间</p>
<ul>
<li>减少 IP 地址冲突：每个连接的设备都必须有一个IP地址。但是，每个地址只能使用一次，重复的地址将导致无法连接一个或两个设备的冲突。</li>
<li>IP地址管理的自动化：如果没有 DHCP，网络管理员将需要手动分配和撤消地址。手动需要随时知道设备何时需要访问网络以及何时需要离开网络。</li>
<li>高效的变更管理：<strong>DHCP 的使用使更改地址，范围或端点变得非常简单</strong>。例如，组织可能希望将其IP寻址方案从一个范围更改为另一个范围。Server配置有新信息，该信息将传播到新端点。同样，如果升级并更换了网络设备，则不需要网络配置</li>
</ul>
<h3 id="dhcp-工作原理"><a class="markdownIt-Anchor" href="#dhcp-工作原理"></a> DHCP 工作原理</h3>
<p>DHCP 协议采用 <strong>UDP</strong> 作为传输协议，<strong>Client</strong> 发送请求消息到 <strong>Server</strong> 的 *<em>Port 67</em>，<strong>Server</strong> 回应应答消息给 <strong>Client</strong> 的 <strong>Port 68</strong>，只有跟 Client 在同一个网段的 Server 才能收到 Client 广播的 <strong>DISCOVER报文</strong>。当 Client 与 Server 不在同一个网段时，必须部署DHCP中继来转发 Client 和Server之间的DHCP报文。 。</p>
<blockquote>
<p>还没有给 Client 配置地址，怎么就有同一网段的地址了？</p>
</blockquote>
<h4 id="非中继"><a class="markdownIt-Anchor" href="#非中继"></a> 非中继</h4>
<p>在没有部署 <strong>DHCP中继</strong> 的场景下，首次接入网络 Client 与 Server 的报文交互过程，该过程称为<strong>DHCP报文四步交互</strong></p>
<p><img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download.png" alt="无中继场景时 Client 首次接入网络的报文交互示意图" /></p>
<p><strong>第一步：发现阶段</strong></p>
<p>首次接入网络的 Client 不知道 Server 的IP地址，为了学习到 Server 的IP地址，Client 以广播方式发送<strong>DISCOVER报文</strong>(目的IP地址为255.255.255.255)给同一网段内的所有设备(包括Server或中继)。<strong>DISCOVER报文</strong>中携带了 Client 的MAC地址等信息</p>
<p><strong>第二步：提供阶段</strong></p>
<p>与 Client 位于同一网段的 Server 都会接收到 <strong>DISCOVER报文</strong>，Server 选择跟接收 <strong>DISCOVER报文</strong>接口的IP地址处于同一网段的地址池，并且从中选择一个可用的IP地址，然后通过<strong>OFFER报文</strong>发送给Client，Server 在地址池中为 Client 分配IP地址的顺序如下：</p>
<ol>
<li>Server 上已配置的与 Client MAC地址静态绑定的 IP 地址。</li>
<li>Client 发送的 <strong>DISCOVER报文</strong>中 <code>Option50</code>(请求IP地址选项)指定的地址</li>
<li>地址池内查找 <code>Expired</code> 状态的IP地址，即曾经分配给 Client 的超过租期的IP地址</li>
<li>在地址池内随机查找一个 <code>Idle</code> 状态的IP地址。</li>
<li>如果未找到可供分配的 IP 地址，则地址池依次自动回收超过租期的 <code>Expired</code> 和处于冲突状态 <code>Conflict</code> 的IP地址。回收后如果找到可用的IP地址，则进行分配；否则，Client 等待应答超时后，重新发送<strong>DHCP DISCOVER报文</strong>来申请IP地址</li>
</ol>
<p>通常，<strong>Server</strong> 的地址池中会指定IP地址的租期，如果 <strong>Client</strong> 发送的 <strong>DISCOVER报文</strong> 中携带了期望租期，服务器会将 Client 请求的<strong>期望租期</strong>与其<strong>指定的租期</strong>进行比较，选择其中时间<strong>较短的租期</strong></p>
<p>为了防止分配出去的IP地址跟网络中其他 Client 的IP地址冲突，比如Client所在网段已经手工配置了一个地址池中的地址用于DNS服务器，Server 在发送<strong>DHCP OFFER报文</strong>前通过发送 Source IP = ServerIP地址、Target IP 为预分配出去IP地址的 <strong>ICMP ECHO REQUEST报文</strong> 对分配的IP地址进行地址冲突探测。</p>
<ul>
<li>如果在指定的时间内没有收到应答报文，表示网络中没有 Client 使用这个IP地址，可以分配给 Client ；</li>
<li>如果指定时间内收到应答报文，表示网络中已经存在使用此IP地址的 Client ，则把此地址列为冲突地址，然后等待重新接收到DHCP DISCOVER报文后重新选择</li>
</ul>
<p>此阶段 Server 分配给 Client 的IP地址不一定是最终确定使用的IP地址，因为<strong>DHCP OFFER报文</strong>发送给 Client 等待<strong>16秒</strong> 后如果没有收到 Client 的响应，此地址就可以继续分配给其他 Client 。</p>
<p><strong>第三步：选择阶段</strong></p>
<p>在发现阶段 <code>DISCOVER报文</code> 是广播报文，也就是说有可能有多个 Server 向 Client 回应 <strong>DHCP OFFER报文</strong>，则 Client 一般只接收第一个收到的 DHCP OFFER报文，然后以<strong>广播方式</strong>发送 DHCP REQUEST报文，该报文中包含 Client 想选择的 Server标识符(即Option50，填充了接收的DHCP OFFER报文中<strong>yiaddr字段</strong>的IP地址)</p>
<p>Client 广播发送 DHCP REQUEST报文通知所有的Server，它将选择某个Server提供的IP地址，其他Server可以重新将曾经分配给 Client 的IP地址分配给其他 Client 。</p>
<blockquote>
<p>Server怎么判断这个报文是来请求自己分配出去的IP，还是 Client 用来告诉  Server 不用这个地址（两个DHCP 服务器分配的IP地址可能还都一样，不能通过IP判断是否是自己给的）？</p>
</blockquote>
<p><strong>第四步：确认阶段</strong></p>
<p>当Server收到 Client 发送的<strong>DHCP REQUEST报文</strong>后，Server回应 <strong>DHCP ACK报文</strong>，表示 <strong>DHCP REQUEST报文</strong> 中请求的IP地址(Option50 填充的)分配给 Client 使用。</p>
<ol>
<li>
<p>Client 收到 <strong>DHCP ACK报文</strong>，会广播发送免费<strong>ARP报文</strong>，探测本网段是否有其他终端使用服务器分配的IP地址</p>
<ul>
<li>
<p>如果在指定时间内没有收到回应，表示 Client 可以使用此地址。</p>
</li>
<li>
<p>如果收到了回应，说明有其他终端使用了此地址， Client 会向服务器发送 <strong>DHCP DECLINE报文</strong>，并重新向服务器请求IP地址，同时，服务器会将此地址列为<strong>冲突地址</strong>。当服务器没有空闲地址可分配时，再选择冲突地址进行分配，尽量减少分配出去的地址冲突</p>
<blockquote>
<p>DECLINE 是广播报文吗， 如果发送失败或者  Server无法分配其他地址呢？</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>当 Server 收到 Client 发送的 <strong>DHCP REQUEST报文</strong> 后，如果Client 由于某些原因（例如协商出错或者由于发送REQUEST过慢导致服务器已经把此地址分配给其他 Client )无法分配 <strong>DHCP REQUEST报文</strong>中 <code>Option50</code> 填充的IP地址，则发送<strong>DHCP NAK报文</strong>作为应答，通知 Client 无法分配此IP地址。** Client 需要重新发送DHCP DISCOVER报文来申请新的IP地址**</p>
</li>
</ol>
<h4 id="中继"><a class="markdownIt-Anchor" href="#中继"></a> 中继</h4>
<p>有DHCP中继的场景中，首次接入网络的 Client 和Server的工作原理与<strong>无中继场景时 Client 首次接入网络的工作原理</strong>相同。主要差异是DHCP中继在Server和 Client 之间转发DHCP报文，以保证Server和 Client 可以正常交互。在 Client 看来，DHCP中继就像Server；在Server看来，DHCP中继就像 Client</p>
<p>如下图所示，在部署DHCP中继的场景下，首次接入网络 Client 与Server的报文交互过程</p>
<p><img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download-20230907220000104.png" alt="有中继场景时 Client 首次接入网络的报文交互示意图" /></p>
<p><strong>第一步：发现阶段</strong></p>
<p>DHCP中继接收到 Client 广播发送的 DHCP DISCOVER报文后，进行如下处理：</p>
<ol>
<li>
<p>检查DHCP报文中的<code>hops</code>字段，<strong>如果大于16，则丢弃DHCP报</strong>文；否则，将<code>hops</code>字段加1(表明经过一次DHCP中继)，并继续下面的操作。</p>
</li>
<li>
<p>检查DHCP报文中的<code>giaddr</code>字段。如果是0，将<code>giaddr</code>字段设置为接收DHCP DISCOVER报文的接口IP地址。如果不是0，则不修改该字段，继续下面的操作。</p>
<blockquote>
<p>记录 <code>giaddr</code> 的目的就是在 DHCP 地址池中分配相同网段的 IP 地址</p>
</blockquote>
</li>
<li>
<p>将DHCP报文的目的IP地址改为<strong>Server或下一跳中继的IP地址</strong>，<strong>源地址改为中继连接 Client 的接口地址</strong>，通过路由转发将DHCP报文<strong>单播</strong>发送到Server或下一跳中继</p>
</li>
</ol>
<p>如果 Client 与Server之间存在多个DHCP中继，后面的中继接收到DHCP DISCOVER报文的处理流程同前面所述</p>
<p><strong>第二步：提供阶段</strong></p>
<p>Server接收到DHCP DISCOVER报文后，<strong>选择与报文中<code>giaddr</code>字段为同一网段的地址池</strong>，并为 Client 分配IP地址等参数，然后向<code>giaddr</code>字段标识的DHCP中继单播发送DHCP OFFER报文。</p>
<p>DHCP中继收到DHCP OFFER报文后，会进行如下处理：</p>
<ol>
<li>
<p>检查报文中的<code>giaddr</code>字段，<strong>如果不是接口的地址，则丢弃该报文</strong>；否则，继续下面的操作。</p>
<blockquote>
<p>DHCP 服务器怎么知道是不是中继过来的？通过 hops 吗？</p>
</blockquote>
</li>
<li>
<p>DHCP中继检查报文的<strong>广播标志位</strong>。如果广播标志位为1，则将DHCP OFFER报文广播发送给 Client ；否则将DHCP OFFER报文单播发送给 Client 。</p>
<blockquote>
<p>广播标志位是什么时候设置的？</p>
<p>为什么 DHCP OFFER 需要官博发送给 DHCP  Client</p>
</blockquote>
</li>
</ol>
<p><strong>第三步：选择阶段</strong></p>
<p>中继接收到来自 Client 的DHCP REQUEST报文的处理过程同无中继场景下的选择阶段。</p>
<p><strong>第四步：确认阶段</strong></p>
<p>中继接收到来自服务器的DHCP ACK报文的处理过程同无中继场景下的确认阶段。</p>
<h4 id="续租"><a class="markdownIt-Anchor" href="#续租"></a> 续租</h4>
<p>DHCP提供了两种地址分配机制，可以根据网络需求为不同的主机选择不同的分配策略。</p>
<ul>
<li>动态分配机制：通过DHCP为主机分配一个有使用期限的IP地址</li>
<li>静态分配机制：网络管理员通过DHCP为指定的主机分配固定的IP地址。</li>
</ul>
<p>Client 向 Server 申请地址时可以携带期望租期，将分配租期与期望租期比较，**分配其中一个较短的租期给 Client **。租期到期或者 Client 下线释放地址后，服务器会收回该IP地址，收回的IP地址可以继续分配给其他 Client 使用。这种机制可以提高IP地址的利用率，避免 Client 下线后IP地址继续被占用。如果 Client 希望继续使用该地址，需要更新IP地址的租期(如延长IP地址租期)，更新租期过程如下</p>
<p><img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download-20230907220722271.png" alt=" Client 更新租期示意图" /></p>
<ol>
<li>当租期达到<strong>50%(T1)<strong>时，Client 会自动以</strong>单播</strong>的方式向 Server 发送 <strong>DHCP REQUEST报文</strong>，请求更新IP地址租期
<ul>
<li>如果收到 Server 回应的 <strong>DHCP ACK报文</strong>，则租期更新成功(即租期从0开始计算)；</li>
<li>如果收到 <strong>DHCP NAK报文</strong>，则重新发送 <strong>DHCP DISCOVER报文</strong>请求新的IP地址。</li>
</ul>
</li>
<li>当租期达到<strong>87.5%(T2)<strong>时，如果仍未收到Server的应答，Client 会自动以</strong>广播</strong>的方式向 Server 发送 <strong>DHCP REQUEST报文</strong>，请求更新IP地址租期。后续处理逻辑同上</li>
<li>如果租期时间到时都没有收到服务器的回应， Client 停止使用此IP地址，重新发送DHCP DISCOVER报文请求新的IP地址。</li>
</ol>
<p>Client 在租期时间到之前，如果不想使用分配的IP地址(例如 Client 网络位置需要变更)，会触发 Client 向 Server 发送 <strong>DHCP RELEASE报文</strong>，通知 Server 释放IP地址的租期。Server 会保留这个 Client 的配置信息，将IP地址列为曾经分配过的IP地址中，以便后续重新分配给该 Client 或其他 Client 。 Client 可以通过发送 <strong>DHCP INFORM报文</strong>向服务器请求更新配置信息</p>
<p>部署DHCP中继时，更新租期的过程与上述过程相似。</p>
<p><img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/download-20230907220805159.png" alt=" Client 通过DHCP中继更新租期示意图" /></p>
<p><strong>如果不是首次呢，比如客户端重启了？</strong></p>
<p>如果客户端重启后，会自动发送 <strong>DHCP REQUEST广播</strong> 给 Server 以便请求继续租用原来使用的IP地址，</p>
<ul>
<li>如果服务器收到这个消息，确认客户端可以使用该地址，则回答一个<strong>DHCP ACK</strong>确认消息</li>
<li>如果此IP地址已经无法再分配，则返回一个 <strong>DHCP NCK</strong>否认信息，客户端收到这个信息以后，则必须重新发送 DHCP Discovery消息获取新的地址(启动首次登录的流程)。 <strong>若没有得到响应，则尝试与网关通信，如果通信正常，这个租期还没到期的话，则可以继续使用，但是不能和网关通信的话，则会获得169.254.0.1~169.254.255.254之间的IP地址，然后每隔5min尝试更新租约</strong></li>
</ul>
<h3 id="dhcp-报文"><a class="markdownIt-Anchor" href="#dhcp-报文"></a> DHCP 报文</h3>
<p>Server 与 Client 之间通过DHCP报文进行通信。DHCP报文是基于UDP协议传输的。Client 使用的端口号为68，Server 使用的端口号为67。目前DHCP定义了如下八种类型报文，<strong>每种报文的格式相同，只是某些字段的取值不同</strong></p>
<table>
<thead>
<tr>
<th>报文名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DHCP DISCOVER</td>
<td>Client 首次登录网络时进行DHCP交互过程发送的第一个报文，用来寻找Server。</td>
</tr>
<tr>
<td>DHCP OFFER</td>
<td>Server用来响应<strong>DHCP DISCOVER报文</strong>，此报文携带了各种配置信息。</td>
</tr>
<tr>
<td>DHCP REQUEST</td>
<td>此报文用于以下三种用途。<br />1.  Client 初始化后，发送广播的 <strong>DHCP REQUEST报文</strong>来回应服务器的<strong>DHCP OFFER报文</strong>。<br />2.  Client 重启后，发送广播的 <strong>DHCP REQUEST报文</strong>来确认先前被分配的IP地址等配置信息。<br />3. 当 Client 已经和某个IP地址绑定后，发送 <strong>DHCP REQUEST单播或广播报文</strong>来更新IP地址的租约。</td>
</tr>
<tr>
<td>DHCP ACK</td>
<td>Server 对 Client 的<strong>DHCP REQUEST报文</strong>的确认响应报文，Client收到此报文后，才真正获得了IP地址和相关的配置信息。</td>
</tr>
<tr>
<td>DHCP NAK</td>
<td>服务器对Client 的<strong>DHCP REQUEST报文</strong>的拒绝响应报文，例如Server收到DHCP REQUEST报文后，没有找到相应的租约记录，则发送DHCP NAK 报文作为应答，告知 Client 无法分配合适IP地址。</td>
</tr>
<tr>
<td>DHCP DECLINE</td>
<td>当 Client 发现服务器分配给它的IP地址发生冲突时会通过发送此报文来通知服务器，并且会重新向服务器申请地址。</td>
</tr>
<tr>
<td>DHCP RELEASE</td>
<td>Client 可通过发送此报文主动释放服务器分配给它的IP地址，当服务器收到此报文后，可将这个IP地址分配给其它的 Client 。</td>
</tr>
<tr>
<td>DHCP INFORM</td>
<td>Client 获取IP地址后，如果需要向Server获取更为详细的配置信息(网关地址、DNS服务器地址)，则向Server发送DHCP INFORM请求报文。</td>
</tr>
</tbody>
</table>
<p>报文地址：</p>
<p>DHCP 四步交互如下</p>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907230303654.png" alt="image-20230907230303654" style="zoom:80%;" />
<p>服务端的端口是 67，客户端的端口是 68</p>
<p>这里有一个疑问就是 192.168.0.10 是从哪里来的，DHCP 服务器分配之后直接写进去了</p>
<h4 id="discover"><a class="markdownIt-Anchor" href="#discover"></a> Discover</h4>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907230549875.png" alt="image-20230907230549875" style="zoom:50%;" />
<p>DHCP 报文格式一样，只是最后的 Option 不同，前面包含的字段如下：</p>
<ul>
<li><strong>Message type</strong>：报文的操作类型。分为请求报文和响应报文，1为请求报文，2为响应报文。具体报文类型在option字段中标识</li>
<li><strong>Hardware type</strong>：DHCP客户端的硬件地址类型。1表示ethernet地址</li>
<li><strong>Hardeare address length</strong>：DHCP客户端的硬件地址长度。Ethernet地址为6</li>
<li><strong>Hops</strong>：DHCP报文经过的DHCP中继的数目。初始为0，报文每经过一个DHCP中继，该字段就会增加1</li>
<li><strong>Transaction ID</strong>: 客户端发起一次请求时选择的随机数，用来标识一次地址请求过程</li>
<li><strong>Seconds elapsed</strong>: Client 开始DHCP请求后所经过的时间。目前尚未使用，固定取0</li>
<li><strong>Bootp flags</strong>：DHCP服务器响应报文是采用单播还是广播方式发送。<strong>只使用第0比特位，0表示采用单播方式，1表示采用广播方式</strong>，其余比特保留不用</li>
<li><strong>Client IP address</strong>: DHCP客户端的IP地址</li>
<li><strong>Your(client) IP address</strong>: DHCP服务器分配给客户端的IP地址</li>
<li><strong>Next server IP address</strong>：DHCP客户端获取IP地址等信息的服务器IP地址</li>
<li><strong>Relay agent IP address</strong>: DHCP客户端发出请求报文后经过的第一个DHCP中继的IP地址</li>
<li><strong>Client MAC address</strong>: DHCP客户端的硬件地址</li>
<li><strong>Server host name</strong>: DHCP客户端获取IP地址等信息的服务器名称</li>
<li><strong>Boot file name</strong>: DHCP服务器为DHCP客户端指定的启动配置文件名称及路径信息</li>
<li><strong>Magic cookie</strong>: 标识和解释DHCP消息的元素，有助于确保不同设备之间的协议兼容性，并提供了消息类型和选项格式的关键信息</li>
<li><strong>Option</strong>：可选变长选项字段，包含报文的类型、有效租期、DNS服务器的IP地址和WINS服务器的IP地址等配置信息。</li>
</ul>
<p>因为是广播报文，所以目的地址是 <code>255.255.255.255</code>，其中</p>
<ul>
<li>Option(53): 表示 DHCP 消息类型，Discover(1)</li>
<li>Option(50): 用来记录请求的 IP</li>
<li>Option(55): 用来请求其他参数</li>
<li>Option(61): 客户端标识符</li>
</ul>
<h4 id="offer"><a class="markdownIt-Anchor" href="#offer"></a> Offer</h4>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907230844722.png" alt="image-20230907230844722" style="zoom:50%;" />
<p>这里也包含了很多 Option:</p>
<ul>
<li>Option(53): DHCP 消息类型，Offer(2)</li>
<li>Option(1): 子网掩码， <code>255.255.255.0</code></li>
<li>Option(58): 续租时间 T1，一般为租期的 50%</li>
<li>Option(59): 重新发起T2, 租约响应超时，重新发起广播时间，一般位租期的 87.5%</li>
<li>Option(51): 租约</li>
<li>Option(54): DHCP服务器标识符选项</li>
</ul>
<h4 id="request"><a class="markdownIt-Anchor" href="#request"></a> Request</h4>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907231535947.png" alt="image-20230907231535947" style="zoom:50%;" />
<p>这里也包含了很多 Option:</p>
<ul>
<li>Option(53): DHCP 消息类型，Request(3)</li>
<li>Option(61): 客户段标识</li>
<li>Option(50):  请求的 IP</li>
<li>Option(54):  服务端标识</li>
<li>Option(55): 请求的参数</li>
</ul>
<h4 id="ack"><a class="markdownIt-Anchor" href="#ack"></a> ACK</h4>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_3/image-20230907231557794.png" alt="image-20230907231557794" style="zoom:50%;" />
<p>这里也包含了很多 Option:</p>
<ul>
<li>Option(53): DHCP 消息类型，Ack(5)</li>
<li>Option(1): 子网掩码， <code>255.255.255.0</code></li>
<li>Option(58): 续租时间 T1，一般为租期的 50%</li>
<li>Option(59): 重新发起T2, 租约响应超时，重新发起广播时间，一般位租期的 87.5%</li>
<li>Option(51): 租约</li>
<li>Option(54): DHCP服务器标识符选项</li>
</ul>
<h3 id="dhcpv6"><a class="markdownIt-Anchor" href="#dhcpv6"></a> DHCPv6</h3>
<p><code>546</code>号端口用于 <code>DHCPv6 Client</code>，而不用于DHCPv4，是为<code>DHCP failover</code>服务，这是需要特别开启的服务，<code>DHCP failover</code>是用来做<code>双机热备</code>的</p>
<h3 id="参考链接"><a class="markdownIt-Anchor" href="#参考链接"></a> 参考链接</h3>
<ol>
<li><a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/DHCP.html" target="_blank" rel="noopener">https://info.support.huawei.com/info-finder/encyclopedia/zh/DHCP.html</a></li>
<li><a href="https://support.huawei.com/hedex/hdx.do?docid=EDOC1100087046&amp;id=ZH-CN_CONCEPT_0176371515" target="_blank" rel="noopener">https://support.huawei.com/hedex/hdx.do?docid=EDOC1100087046&amp;id=ZH-CN_CONCEPT_0176371515</a></li>
<li><a href="https://support.huawei.com/hedex/hdx.do?docid=EDOC1100087046&amp;id=ZH-CN_CONCEPT_0176371535" target="_blank" rel="noopener">https://support.huawei.com/hedex/hdx.do?docid=EDOC1100087046&amp;id=ZH-CN_CONCEPT_0176371535</a></li>
<li><a href="https://info.support.huawei.com/info-finder/encyclopedia/zh/ICMP.html" target="_blank" rel="noopener">https://info.support.huawei.com/info-finder/encyclopedia/zh/ICMP.html</a></li>
<li><a href="https://wiki.wireshark.org/DHCP.md" target="_blank" rel="noopener">https://wiki.wireshark.org/DHCP.md</a></li>
</ol>

      
    </div>
    <div class="article-footer">
      <!--
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://xboom.github.io/2023/09/07/Protocol/%E5%8D%8F%E8%AE%AE-04-DHCP/" title="协议-04-DHCP" target="_blank" rel="external">http://xboom.github.io/2023/09/07/Protocol/协议-04-DHCP/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/XBoom" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/XBoom" target="_blank"><span class="text-dark">Yuan Kang</span><small class="ml-1x">Learn and live</small></a></h3>
        <div>Talk is cheap, Show me your code</div>
      </div>
    </figure>
  </div>
</div>


      -->
    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    
    <li class="next">
      <a href="/2023/07/15/Go/Go-27-SyncPool/" title="Go-27-SyncPool"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn " data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="Catalogue" role="button">    <span>[&nbsp;</span><span>Catalogue</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/XBoom" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=728081687@qq.com" target="_blank" title="Email" data-toggle=tooltip data-placement=top><i class="icon icon-email"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <!--
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
        -->
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   


<!-- custom analytics part create by xiamo -->
<script defer src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
<script defer>
AV.init({
  appId: 'SbGHqy6xigse8A1P9rctla9N-gzGzoHsz',
  appKey: 'Yjv3BxtjwA5IStDccnVj1eQr'
});

function showTime(Counter) {
	var query = new AV.Query(Counter);
		var visitors= $('.leancloud_visitors');
		query.greaterThanOrEqualTo("time", 0);		
		query.find({
			success: function(results) {
				if (results.length == 0) {				
					return;
				}
				var data = results;
				visitors.each(function(){
					var url = $(this).attr('id').trim();					
					for (var i = 0; i < data.length; i++) {
						var object = data[i];
						var content = object.get('time');
						var _url = object.get('url')
						if(url == _url){
							$(this).text(content);
						}
					}
				})
				
			},
			error: function(object, error) {
				console.log("Error: " + error.code + " " + error.message);
			}
		});
}

function addCount(Counter) {
	var Counter = AV.Object.extend("Counter");
	url = $(".leancloud_visitors").attr('id').trim();
	title = $(".leancloud_visitors").attr('data-flag-title').trim();
	var query = new AV.Query(Counter);
	query.equalTo("url", url);
	query.find({
		success: function(results) {
			if (results.length > 0) {
				var counter = results[0];
				counter.fetchWhenSave(true);
				counter.increment("time");
				counter.save(null, {
					success: function(counter) {
						var content = counter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(counter, error) {
						console.log('Failed to save Visitor num, with error message: ' + error.message);
					}
				});
			} else {
				var newcounter = new Counter();
				newcounter.set("title", title);
				newcounter.set("url", url);
				newcounter.set("time", 1);
				newcounter.save(null, {
					success: function(newcounter) {
					    console.log("newcounter.get('time')="+newcounter.get('time'));
						var content = newcounter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(newcounter, error) {
						console.log('Failed to create');
					}
				});
			}
		},
		error: function(error) {
			console.log('Error:' + error.code + " " + error.message);
		}
	});
}
$(function() {
	var Counter = AV.Object.extend("Counter");
	if ($('.leancloud_visitors').length == 1) {
		addCount(Counter);
	} else {
		showTime(Counter);
	}
}); 
</script>



   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'SbGHqy6xigse8A1P9rctla9N-gzGzoHsz',
    appKey: 'Yjv3BxtjwA5IStDccnVj1eQr',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     






    <script defer>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?35ec0b872cf5aada9525fd9f0487c238";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>



</body>
</html>