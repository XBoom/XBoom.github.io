<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>MySql入门1-架构 | XBoom Dove</title>
  <meta name="description" content="MySQL架构   连接器 连接器：负责跟客户端建立连接、获取权限、维持和管理连接  连接命令：mysql -h$ip -P$port -u$user -p  连接默认端口是3306，可通过修改my.cnf配置文件指定端口 如果客户端太长时间没动静，连接器会自动断开。由参数wait_timeout控制的，默认值是8小时  show variables like ‘wait_timeout’;">
<meta property="og:type" content="article">
<meta property="og:title" content="MySql入门1-架构">
<meta property="og:url" content="http://xboom.github.io/2021/07/22/MySql/MySql%E5%85%A5%E9%97%A81-%E6%9E%B6%E6%9E%84/index.html">
<meta property="og:site_name" content="XBoom Dove">
<meta property="og:description" content="MySQL架构   连接器 连接器：负责跟客户端建立连接、获取权限、维持和管理连接  连接命令：mysql -h$ip -P$port -u$user -p  连接默认端口是3306，可通过修改my.cnf配置文件指定端口 如果客户端太长时间没动静，连接器会自动断开。由参数wait_timeout控制的，默认值是8小时  show variables like ‘wait_timeout’;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210718145041.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724112032.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724113757.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724122310.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724190729.png">
<meta property="og:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210725103545.png">
<meta property="article:published_time" content="2021-07-21T23:20:02.000Z">
<meta property="article:modified_time" content="2022-06-25T07:00:00.000Z">
<meta property="article:author" content="XBoom Dove">
<meta property="article:tag" content="MySql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210718145041.png">
  <!-- Canonical links -->
  <link rel="canonical" href="http://xboom.github.io/2021/07/22/MySql/MySql%E5%85%A5%E9%97%A81-%E6%9E%B6%E6%9E%84/index.html">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="XBoom Dove" type="application/atom+xml">
</head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/XBoom" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">XBoom Dove</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Linux Developer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">Repository</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/XBoom" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=728081687@qq.com" target="_blank" title="Email" data-toggle=tooltip data-placement=top><i class="icon icon-email"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>Keep on going never give up!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithms-To-Live-By/">Algorithms To Live By</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Design-Patterns/">Design Patterns</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Go/">Go</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Grpc/">Grpc</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Interesting-Algorithm/">Interesting Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux-Depth/">Linux Depth</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MQ/">MQ</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Microservices/">Microservices</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySql/">MySql</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Protocol/">Protocol</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP/IP</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go-zero/">go-zero</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithms-To-Live-By/" rel="tag">Algorithms To Live By</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Design-Patterns/" rel="tag">Design Patterns</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Event/" rel="tag">Event</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Go/" rel="tag">Go</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Grpc/" rel="tag">Grpc</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/" rel="tag">Kafka</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MQ/" rel="tag">MQ</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Memory/" rel="tag">Memory</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Microservices/" rel="tag">Microservices</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySql/" rel="tag">MySql</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quic/" rel="tag">Quic</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SMB/" rel="tag">SMB</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/" rel="tag">TCP/IP</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TLS/" rel="tag">TLS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go-zero/" rel="tag">go-zero</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a><span class="tag-list-count">5</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Algorithm/" style="font-size: 13.11px;">Algorithm</a> <a href="/tags/Algorithms-To-Live-By/" style="font-size: 13.56px;">Algorithms To Live By</a> <a href="/tags/Design-Patterns/" style="font-size: 14px;">Design Patterns</a> <a href="/tags/Docker/" style="font-size: 13px;">Docker</a> <a href="/tags/Event/" style="font-size: 13px;">Event</a> <a href="/tags/Go/" style="font-size: 13.89px;">Go</a> <a href="/tags/Grpc/" style="font-size: 13.22px;">Grpc</a> <a href="/tags/HTTP/" style="font-size: 13px;">HTTP</a> <a href="/tags/Kafka/" style="font-size: 13.33px;">Kafka</a> <a href="/tags/Linux/" style="font-size: 13.22px;">Linux</a> <a href="/tags/MQ/" style="font-size: 13.44px;">MQ</a> <a href="/tags/Memory/" style="font-size: 13px;">Memory</a> <a href="/tags/Microservices/" style="font-size: 13.22px;">Microservices</a> <a href="/tags/MySql/" style="font-size: 13.67px;">MySql</a> <a href="/tags/Quic/" style="font-size: 13px;">Quic</a> <a href="/tags/Redis/" style="font-size: 13.56px;">Redis</a> <a href="/tags/SMB/" style="font-size: 13px;">SMB</a> <a href="/tags/TCP-IP/" style="font-size: 13.44px;">TCP/IP</a> <a href="/tags/TLS/" style="font-size: 13px;">TLS</a> <a href="/tags/go-zero/" style="font-size: 13.78px;">go-zero</a> <a href="/tags/k8s/" style="font-size: 13.44px;">k8s</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a><span class="archive-list-count">28</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Algorithms-To-Live-By/">Algorithms To Live By</a>
              </p>
              <p class="item-title">
                <a href="/2023/02/02/Algorithms%20To%20Live%20By/%E7%AE%97%E6%B3%95-E10C-%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0/" class="title">算法-E10C-最大公约数</a>
              </p>
              <p class="item-date">
                <time datetime="2023-02-02T12:25:25.494Z" itemprop="datePublished">2023-02-02</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Go/">Go</a>
              </p>
              <p class="item-title">
                <a href="/2023/01/04/Go/Go%E5%85%A5%E9%97%A822-%E5%8D%8F%E7%A8%8B%E6%B1%A0%E9%97%AE%E9%A2%98/" class="title">Go入门22-协程池问题</a>
              </p>
              <p class="item-date">
                <time datetime="2023-01-04T13:45:13.344Z" itemprop="datePublished">2023-01-04</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Go/">Go</a>
              </p>
              <p class="item-title">
                <a href="/2023/01/04/Go/Go%E5%85%A5%E9%97%A821-SetFinalizer/" class="title">Go入门21-SetFinalizer</a>
              </p>
              <p class="item-date">
                <time datetime="2023-01-04T13:45:13.344Z" itemprop="datePublished">2023-01-04</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Algorithms-To-Live-By/">Algorithms To Live By</a>
              </p>
              <p class="item-title">
                <a href="/2022/12/11/Algorithms%20To%20Live%20By/%E7%AE%97%E6%B3%95%E4%B9%8B%E7%BE%8E-%E5%85%AB%E6%95%B0%E7%A0%81%E9%97%AE%E9%A2%98/" class="title">算法之美-八数码问题</a>
              </p>
              <p class="item-date">
                <time datetime="2022-12-11T09:47:28.000Z" itemprop="datePublished">2022-12-11</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Grpc/">Grpc</a>
              </p>
              <p class="item-title">
                <a href="/2022/10/19/Grpc/Grpc-03-%E8%A7%A3%E6%9E%90%E5%99%A8%E5%8E%9F%E7%90%86/" class="title">Grpc-03-解析器原理</a>
              </p>
              <p class="item-date">
                <time datetime="2022-10-18T16:18:01.000Z" itemprop="datePublished">2022-10-19</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
  <aside class="sidebar sidebar-toc collapse   in  " id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">Catalogue</h3>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql架构"><span class="toc-number">1.</span> <span class="toc-text"> MySQL架构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#连接器"><span class="toc-number">1.1.</span> <span class="toc-text"> 连接器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查询缓存"><span class="toc-number">1.2.</span> <span class="toc-text"> 查询缓存</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#逻辑存储结构"><span class="toc-number">2.</span> <span class="toc-text"> 逻辑存储结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关键特征"><span class="toc-number">3.</span> <span class="toc-text"> 关键特征</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#后台线程"><span class="toc-number">3.1.</span> <span class="toc-text"> 后台线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#内存"><span class="toc-number">3.2.</span> <span class="toc-text"> 内存</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#缓冲池"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 缓冲池</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#重做日志缓冲"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 重做日志缓冲</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#额外内存池"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 额外内存池</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#checkpoint技术"><span class="toc-number">3.3.</span> <span class="toc-text"> CheckPoint技术</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#插入缓冲"><span class="toc-number">3.4.</span> <span class="toc-text"> 插入缓冲</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#两次写"><span class="toc-number">3.5.</span> <span class="toc-text"> 两次写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自适应哈希索引"><span class="toc-number">3.6.</span> <span class="toc-text"> 自适应哈希索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#异步io"><span class="toc-number">3.7.</span> <span class="toc-text"> 异步IO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#刷新邻接页"><span class="toc-number">3.8.</span> <span class="toc-text"> 刷新邻接页</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#存储引擎比较"><span class="toc-number">4.</span> <span class="toc-text"> 存储引擎比较</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-MySql/MySql入门1-架构" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      MySql入门1-架构
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/07/22/MySql/MySql%E5%85%A5%E9%97%A81-%E6%9E%B6%E6%9E%84/" class="article-date">
	  <time datetime="2021-07-21T23:20:02.000Z" itemprop="datePublished">2021-07-22</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/MySql/">MySql</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/MySql/" rel="tag">MySql</a>
  </span>


        

	<span class="article-read hidden-xs">
    	<i class="icon icon-eye-fill" aria-hidden="true"></i>
    	<span id="/2021/07/22/MySql/MySql%E5%85%A5%E9%97%A81-%E6%9E%B6%E6%9E%84/" class="leancloud_visitors"  data-flag-title="MySql入门1-架构">0</span>
    </span>

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/07/22/MySql/MySql%E5%85%A5%E9%97%A81-%E6%9E%B6%E6%9E%84/#comments" class="article-comment-link">Comments</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h3 id="mysql架构"><a class="markdownIt-Anchor" href="#mysql架构"></a> MySQL架构</h3>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210718145041.png" alt="image-20210718145041739" style="zoom:50%;" />
<h4 id="连接器"><a class="markdownIt-Anchor" href="#连接器"></a> 连接器</h4>
<p><strong>连接器</strong>：负责跟客户端建立连接、获取权限、维持和管理连接</p>
<blockquote>
<p>连接命令：<code>mysql -h$ip -P$port -u$user -p</code></p>
</blockquote>
<p>连接默认端口是<strong>3306</strong>，可通过修改<code>my.cnf</code>配置文件指定端口</p>
<p>如果客户端太长时间没动静，连接器会自动断开。由参数wait_timeout控制的，默认值是8小时</p>
<blockquote>
<p>show variables like ‘wait_timeout’;</p>
</blockquote>
<ol>
<li>定期断开长连接。使用一段时间，或者程序里面判断执行过一个占用内存的大查询后，断开连接，之后要查询再重连。</li>
<li>如果你用的是 MySQL 5.7 或更新版本，可在每次执行一个比较大的操作后，通过执 <em>mysql_reset_connection</em> 来重新初始化连接资源。这个过程不需要重连和重新做权限验证，但是会将连接恢复到刚刚创建完时的状态</li>
</ol>
<p>可以使用TCP/IP套接字，命名管道和共享内存，UNIX域套接字进行连接</p>
<h4 id="查询缓存"><a class="markdownIt-Anchor" href="#查询缓存"></a> 查询缓存</h4>
<p>查询缓存：连接建立完成后，就可以执行 select 语句了，执行查询缓存。</p>
<p><strong>之前执行过的语句及其结果可能会以 key-value 对的形式，被直接缓存在内存中</strong>，key 是查询的语句，value 是查询的结果</p>
<h3 id="逻辑存储结构"><a class="markdownIt-Anchor" href="#逻辑存储结构"></a> 逻辑存储结构</h3>
<p>InnoDB存储引擎将所有数据都逻辑的存放在一个空间中，称为表空间，表空间又由以下结构组成</p>
<ul>
<li>段(segment)</li>
<li>区(extent)</li>
<li>页(page)</li>
<li>行(row)</li>
</ul>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724112032.png" alt="image-20210724112032115" style="zoom:50%;" />
<p>表空间(Tablespace)：默认情况InnoDB有一个共享表空间ibdata1, 即所有数据都存放在和这个表空间内。</p>
<p>如果用户开启 <code>innodb_file_or_table</code>，则每张表的数据(数据、索引、插入缓冲BitMap)可以单独放到一个表空间中，而回滚(undo)信息，插入缓冲索引页、系统事务信息、二次写缓冲(Double write buffer)还是存放在原来的共享表空间</p>
<p>InnoDB数据页由以下7个部分组成</p>
<ul>
<li>File Header(文件头)</li>
<li>Page Heade(页头)</li>
<li>Infimun 和 Supermum Records</li>
<li>User Records(用户记录)</li>
<li>Free Space(空闲空间)</li>
<li>Page Directory(页目录)</li>
<li>File Trailer(文件结尾信息)</li>
</ul>
<p>其中 File Header 38 字节, Page Header 56 字节, File Trailer 8 字节，用来标记页信息</p>
<p>而 User Records, Free Sapce, Page Directory  为实际的行存储空间，所以大小是动态的</p>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724113757.png" alt="image-20210724113757557" style="zoom:30%;" />
<p>Infimun 记录的是比任何主键都要小的值， Supermum Records 指可能比任何可能的值还要大的值，这两个值在页创建的时候建立，且永远不会被删除</p>
<h3 id="关键特征"><a class="markdownIt-Anchor" href="#关键特征"></a> 关键特征</h3>
<h4 id="后台线程"><a class="markdownIt-Anchor" href="#后台线程"></a> 后台线程</h4>
<p>后台存在多个线程处理不同的任务</p>
<ol>
<li>master thread: 负责将缓冲池中的数据异步刷新到磁盘，保证数据的一致性</li>
<li>IO Thread: 大量使用AIO(Async IO)来处理写IO请求。而IO Thread的主要工作是负责这些IO请求的回调处理</li>
<li>Purge Thread: 事务提交后，其锁使用的 undolog 可能不再需要，一次通过PurgeThread来回收已经使用并分配的undo页</li>
<li>Page Cleaner Thread: 脏页的刷新操作</li>
</ol>
<h4 id="内存"><a class="markdownIt-Anchor" href="#内存"></a> 内存</h4>
<h5 id="缓冲池"><a class="markdownIt-Anchor" href="#缓冲池"></a> 缓冲池</h5>
<p>InnoDB存储引擎是基于磁盘存储的。使用缓冲池技术降低CPU与磁盘之间的速率鸿沟</p>
<p>读取页的操作，首先将从磁盘读到的页存放在缓冲池中国暖，这个过程称为将页&quot;FIX&quot;在缓冲池中，下一次再读相同的页时，首先判断该页是否存在缓冲池中</p>
<p>修改页的操作，首先修改在缓冲池中的页，然后再已一定的频率刷新到磁盘上，页从缓冲池刷新回磁盘的操作并不是在每次页发生更新时触发，而是通过一种称为 CheckPoint的机制刷新回磁盘。</p>
<p>32位操作系统最大支持64G内存，而64位操作系统支持512G内存，通过 <code>innodb_buffer_pool_size</code>设置</p>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724122310.png" alt="image-20210724122310571" style="zoom:50%;" />
<ol>
<li><strong>LRU</strong></li>
</ol>
<p>缓冲池通过LRU(Latest Recent Used，最近最少使用)算法来进行管理的。即最频繁使用的页在LRU列表的前端，而最少使用的页在LRU列表的尾端</p>
<p>InnoDB对LRU进行了一些优化，还加入了<code>midpoint</code>位置，默认在LRU列表长度的5/8处。新读到的页并不是直接放到LRU列表的首部，而是放入到LRU列表的<code>midpoint</code>位置</p>
<blockquote>
<p>为什么不直接放到LRU的首部？</p>
<p>某些操作可能会使缓存的页被刷出，从而影响缓冲池的效率。如索引或数据的扫描操作</p>
</blockquote>
<p>使用<code>innodb_old_blocks_time</code> 表示页读取到mid位置后需要等待多久才能加入到LRU列表的热端</p>
<ol start="2">
<li><strong>Free</strong></li>
</ol>
<p>LRU 用来管理已经读取的页，但当数据库刚启动时，LRU列表是空的，这时页都放在Free列表中</p>
<p>当需要从缓冲池中分页时，首先从Free列表中查找是否有可用的空闲页，若有则从Free列表中删除，放入到LRU列表中。否则淘汰LRU列表末尾的页，将该内存空间分配给新的页。</p>
<ul>
<li>当页从LRU列表的old部分加入到new部分时，称此时发生的操作为<code>page made young</code></li>
<li>当页因<code>innodb_old_blocks_time</code>而没有从old部分移动到new部分的操作称为<code>page not made young</code></li>
</ul>
<ol start="3">
<li><strong>FLUSH</strong></li>
</ol>
<p>在LRU列表中的页被修改后，称该页为<strong>脏页(dirty page</strong>),即缓冲池中的页和磁盘上的页数据不一致。数据库会通过CHECKPOINT机制将脏页刷新回磁盘，而Flush列表中的页即为脏页列表。</p>
<blockquote>
<p>注意：脏页既存在于LRU列表中，也存在于Flush列表中。</p>
<p>LRU列表用来管理缓冲池中页的可用性</p>
<p>Flush列表用来管理将页刷新回磁盘，二者互不影响</p>
</blockquote>
<h5 id="重做日志缓冲"><a class="markdownIt-Anchor" href="#重做日志缓冲"></a> 重做日志缓冲</h5>
<p>内存区域除了缓冲池，还有重做日志缓冲(redo log buffer)。InnoDB存储引擎首先将重做日志先放入到这个缓冲区，然后按一定频率将其刷新到重做日志文件</p>
<blockquote>
<p>重做日志缓冲区不需要设置太大，因为一般没买哦就会将重做日志缓冲刷新到日志文件</p>
</blockquote>
<p>实际上，8M的重做日志缓冲池足矣，因为下列三种情况会将重做日志缓冲内容刷新到外部磁盘的重做日志文件中</p>
<ul>
<li>Master Thread 每一秒将重做日志缓冲刷新到重做日志文件</li>
<li>每个事务提交时会将重做日志缓冲刷新到重做日志文件</li>
<li>当重做日志缓冲池剩余空间小于1/2时，将重做日志缓冲刷新到重做日志文件</li>
</ul>
<h5 id="额外内存池"><a class="markdownIt-Anchor" href="#额外内存池"></a> 额外内存池</h5>
<p>在InnoDB存储引擎中，对内存的管理是通过一种称为内存堆(heap)的方式进行的，在对一些数据结构本身的内存进行分配时，需要从额外的内存池中进行申请，当该区域的内存不够时，会从缓冲池中神行</p>
<p>例如：分配了缓冲池(innodb_buffer_pool)，但每个缓冲池中的帧缓冲(frame buffer)还有对应的缓冲控制对象(buffer control block)需要从额外内存池中申请</p>
<h4 id="checkpoint技术"><a class="markdownIt-Anchor" href="#checkpoint技术"></a> CheckPoint技术</h4>
<p>当出现脏页，即缓冲池中页的版本比磁盘的新，需要将新版本的页从缓冲池刷新到磁盘。若每次一个页发生变化，就将新页的版本刷新到磁盘，那么这个开销将是非常大。同时如果刷新到磁盘的时候发生宕机，则数据不可恢复</p>
<p>所以事务数据库系统普遍采用Write Ahead Log策略，即当事务提交时，先写重做日志，再修改页。</p>
<p>如果重做日志可以无限地增大，同时缓冲池页足够大，能够缓冲数据库的数据，就不需要将缓冲池中的页的新版本刷新回磁盘。当发生宕机直接使用重做日志恢复整个系统到宕机发生的时刻，这就需要：</p>
<ul>
<li>缓冲池可以缓存数据库中所有的数据</li>
<li>重做日志可以无限增大</li>
</ul>
<p>因此提出CheckPoint技术解决：</p>
<ul>
<li>缩短数据库的恢复时间：当数据库发生宕机，不需要重做所有日志，因为CheckPoint之前的页都已经刷新回磁盘，只需要恢复CheckPoint之后的重做日志</li>
<li>缓冲池不够用时，将脏页刷新到磁盘：根据LRU算法会溢出最近最少使用的页，若此页为脏页，也需要执行CheckPoint刷回磁盘</li>
<li>重做日志不可用时，刷新脏页：因为重做日志是循环使用，不可用是指部分重做日志已经不再需要了</li>
</ul>
<p>InnoDB存储引擎通过LSN(Log Sequence Number)来标记版本(8字节)，每个页有LSN，重做日志也有LSN，CheckPoint也有LSN</p>
<p>在Innodb引擎内部，有两种CheckPoint:</p>
<ul>
<li>Sharp Checkpoint：发生在数据库关闭时将所有的脏页都刷新回磁盘(默认)</li>
<li>Fuzzy Checkpoint: 若在数据库运行时使用 Sharp CheckPoint 将影响数据库使用，所以运行时使用Fuzzy
<ul>
<li>Master Thread CheckPoint: Master Thread 每秒从缓冲池的脏页列表刷新一定比例回磁盘(异步)</li>
<li>FLUSH_LRU_LIST checkPoint: 为了保证LRU列表中有大约100个空闲页，检查(阻塞)LRU中是否有足够的空闲列表，没有则从LRU列表尾端的页移除，如果这些页中有脏页，则进行CheckPoint。这个检查后来单独的Page Ceaner线程中进行</li>
<li>Async/Sync Flush CheckPoint: 重做日志不可用，则从脏页列表中选取。将已经写入到重做日志的LSN记为redo_lsn，将已经刷新回磁盘最新页的LSN记为checkpoint_lsn</li>
<li>Dirty Page too much CheckPoint：当脏页太多强制执行CheckPoint</li>
</ul>
</li>
</ul>
<h4 id="插入缓冲"><a class="markdownIt-Anchor" href="#插入缓冲"></a> 插入缓冲</h4>
<p>虽然缓冲池中有Inert Buffer信息，但Insert Buffer和数据页一样，也是物理页的一个组成部分</p>
<p>如果对于非聚集索引叶子节点的插入不是顺序的(例如创建时间递增插入，则也是顺序的)，这时就需要离散地访问非聚集索引导致插入性能下降</p>
<p>对于非聚集索引的插入或更新操作，不是每一次直接插入到索引页中，而是先判断插入的非聚集索引页是否在缓冲池中，</p>
<ul>
<li>
<p>若存在，则直接插入</p>
</li>
<li>
<p>若不在，则先放入到一个Insert Buffer对象中，然后通过一定频率和情况进行<code>Insert Buffer</code>和辅助索引页子节点的merge操作</p>
</li>
</ul>
<p>Insert Buffer 使用需要同时满足以下两个条件：</p>
<ul>
<li>索引是辅助索引(secondary index)</li>
<li>索引不是唯一(unique)的</li>
</ul>
<p>若MySql数据库发生了宕机，势必有大量Insert Buffer并没有合并到实际的非聚集索引中</p>
<p>辅助索引不能是唯一的，因为在插入缓冲时，数据库并不去查找索引页来判断插入记录的唯一性，如果去查找又会有离散读取的情况发生，从而导致Insert Buffer失去意义</p>
<p>Innsert Buffer 的数据结构是一颗B+树，全局有一颗 Insert Buffer B+ 树，负责对所有的表的辅助索引进行Insert Buffer。这课B+树存放在共享表空间中，默认也就是ibdata1中</p>
<p>由此也有叶节点和非叶节点组成，非叶节点存放的是查询的search key(键值)</p>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210724190729.png" alt="image-20210724190729698" style="zoom:50%;" />
<p>search key 一共占用 9个字节，</p>
<ul>
<li>space(4字节)表示待插入记录所在的表的表空间id,在Innodb存储引擎中，每个表有一个唯一的space id</li>
<li>marker(1字节) 用来兼容老版本的Insert Buffer</li>
<li>Offsert 表示页所在的偏移量，占用4字节</li>
</ul>
<p>当一个辅助索引要插入到页(space, offset)时，如果这个页不在缓冲池中，那么InnoDB存储引擎首先根据上述规则构造一个search key,接下来查询Insert Buffer这颗B+树，然后将这条记录插入到Insert Buffer B+树的叶子节点中</p>
<h4 id="两次写"><a class="markdownIt-Anchor" href="#两次写"></a> 两次写</h4>
<p>如果Insert Buffer 带给InnoDB存储引擎是性能上的提升，那么doublewrite带来的就是数据页的可靠性</p>
<p>当数据库宕机，InnoDB可能正在写入某个页到表中，而这个页只写了一部分(比如一个页16KB的页，只写了4KB)</p>
<p>重做日志中记录的是对页的物理操作。如果这个页本身已经发生了损坏，在对其进行重做是没有意义的，也就是说，在应用(apply)重做日志前，用户需要一个页的副本，当写入失效发生时，先通过页的副本还原该页，再进行重做，这就是doublewrite</p>
<p>doublewrite 由两部分组成:</p>
<ul>
<li>一部分是内存中的doublewrite buffer 大小为2MB</li>
<li>另一部分是物理磁盘上共享表空间中连续的128个页，即2个区(extent)，大小同样为2MB</li>
</ul>
<p>在对缓冲池脏页进行刷新时，并不直接写磁盘，而是通过memcpy函数先将脏页复制到内存中的doublewrite buffer，之后通过doublewrite buffer 再分两次，每次1MB顺序地写入共享表空间的物理磁盘是上，马上调用fsync函数，避免缓冲写带来的问题。因为doublewrite页是连续的，这个过程是循序写的。在完成doublewrite页的写入后，再将doublewrite buffer中的页写入各个表空间文件中，此时的写入则是离散的。</p>
<img src="https://images-1307117474.cos.ap-guangzhou.myqcloud.com/blogs/Blog_Images/20210725103545.png" alt="image-20210725095600938" style="zoom:33%;" />
<h4 id="自适应哈希索引"><a class="markdownIt-Anchor" href="#自适应哈希索引"></a> 自适应哈希索引</h4>
<p>哈希(Hash)是一种非常快的查找方法，时间复杂度为O(1)。而B+树在取决于树的高度(在生产环境中，B+树的高度一般为3~4层)</p>
<p>InnoDB存储引擎会监控对表上各索引页的查询。通过缓冲池的B+树页构造而来，称为自适应哈希索引(Adaptive Hash Index, AHI)。自动根据访问的频率和模式来自动地为某些热点页建立哈希索引。</p>
<p>建立AHI的要求如下：</p>
<ol>
<li>访问模式一样是指查询条件一样。如 <code>where a=xxx</code> 和 <code>where a=xxx and b=xx</code> 交替查询则不会构造AHI</li>
<li>以该模式访问了100次</li>
<li>页通过该模式访问了N次，其中N=页中记录 * 1/16</li>
</ol>
<h4 id="异步io"><a class="markdownIt-Anchor" href="#异步io"></a> 异步IO</h4>
<p>当前的数据库系统都采用异步IO(Asynchronous IO, AIO)的方式来处理磁盘操作</p>
<p>Sync IO是每进行一次IO操作需要等待此次操作结束才能继续接下来的操作。如果用户发出的是一条索引扫描的查询，那么SQL查询语句需要扫描多个索引页，每扫描一个页并等待其完成后再进行下一次的扫描没必要。</p>
<p>AIO是用户发出了一个IO请求之后立即再发出另一个IO请求，当全部IO请求发送完毕后，等待所有IO操作的完成。最大的优势就是进行<code>IO Merge</code>操作。例如需要访问页(space, page_no)为(8,6)、(8,7)、(8,8) 每个页的大小为16KB，AIO会判断这三个页是连续的,因此AIO底层会发送一个IO请求，从(8,6)开始，读取48KB的页</p>
<h4 id="刷新邻接页"><a class="markdownIt-Anchor" href="#刷新邻接页"></a> 刷新邻接页</h4>
<p>当刷新一个脏页是，InnoDB存储引擎会检查该页所在区(extent)的所有页，如果是脏页，那么一起进行刷新。这样通过AIO可以将多个IO写入从左合并为一个IO操作。但存在这样的问题：</p>
<ul>
<li>是不是可能将不怎么脏的页进行了写入，而该页之后又会很快变成脏页</li>
<li>固态硬盘有这较高的IOPS，是否还需要这个特性</li>
</ul>
<p>可以通过 <code>innodb_flush_neighbors</code> 控制开启</p>
<h3 id="存储引擎比较"><a class="markdownIt-Anchor" href="#存储引擎比较"></a> 存储引擎比较</h3>
<table>
<thead>
<tr>
<th>特征</th>
<th style="text-align:center">MyISAM</th>
<th style="text-align:center">BDB</th>
<th style="text-align:center">Memory</th>
<th style="text-align:center">InnoDB</th>
<th style="text-align:center">Archive</th>
<th style="text-align:center">NDB</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sotrage Limits</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center">64TB</td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Transactions</td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>Locking granularity</td>
<td style="text-align:center">表</td>
<td style="text-align:center">页</td>
<td style="text-align:center">表</td>
<td style="text-align:center">行</td>
<td style="text-align:center">行</td>
<td style="text-align:center">行</td>
</tr>
<tr>
<td>MVCC/Snapshot Read</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Geospatial support</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>B-Tree indexes</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Hash indexes</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>Full text search index</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>Data Caches</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Index Caches</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>Compressed data</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>Encrypted data</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Bulk Insert Speed</td>
<td style="text-align:center">High</td>
<td style="text-align:center">High</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Very High</td>
<td style="text-align:center">High</td>
</tr>
<tr>
<td>Storage cost</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">N/A</td>
<td style="text-align:center">High</td>
<td style="text-align:center">VeryLlow</td>
<td style="text-align:center">Low</td>
</tr>
<tr>
<td>Memory cost</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">High</td>
</tr>
<tr>
<td>Cluster database support</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Replication support</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Foreign Key support</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>Backup/Point-in-time recovery</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Query cache support</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td>Update Statistics for Data Dictionary</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
</tbody>
</table>

      
    </div>
    <div class="article-footer">
      <!--
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://xboom.github.io/2021/07/22/MySql/MySql%E5%85%A5%E9%97%A81-%E6%9E%B6%E6%9E%84/" title="MySql入门1-架构" target="_blank" rel="external">http://xboom.github.io/2021/07/22/MySql/MySql入门1-架构/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/XBoom" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/XBoom" target="_blank"><span class="text-dark">XBoom Dove</span><small class="ml-1x">Linux Developer</small></a></h3>
        <div>Talk is cheap, Show me your code</div>
      </div>
    </figure>
  </div>
</div>


      -->
    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/07/24/MySql/MySql%E5%85%A5%E9%97%A82-%E6%96%87%E4%BB%B6/" title="MySql入门2-文件"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/07/22/MySql/MySql%E5%85%A5%E9%97%A83-%E7%B4%A2%E5%BC%95/" title="MySql入门3-索引"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn " data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="Catalogue" role="button">    <span>[&nbsp;</span><span>Catalogue</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/XBoom" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=728081687@qq.com" target="_blank" title="Email" data-toggle=tooltip data-placement=top><i class="icon icon-email"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <!--
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
        -->
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   


<!-- custom analytics part create by xiamo -->
<script defer src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
<script defer>
AV.init({
  appId: 'SbGHqy6xigse8A1P9rctla9N-gzGzoHsz',
  appKey: 'Yjv3BxtjwA5IStDccnVj1eQr'
});

function showTime(Counter) {
	var query = new AV.Query(Counter);
		var visitors= $('.leancloud_visitors');
		query.greaterThanOrEqualTo("time", 0);		
		query.find({
			success: function(results) {
				if (results.length == 0) {				
					return;
				}
				var data = results;
				visitors.each(function(){
					var url = $(this).attr('id').trim();					
					for (var i = 0; i < data.length; i++) {
						var object = data[i];
						var content = object.get('time');
						var _url = object.get('url')
						if(url == _url){
							$(this).text(content);
						}
					}
				})
				
			},
			error: function(object, error) {
				console.log("Error: " + error.code + " " + error.message);
			}
		});
}

function addCount(Counter) {
	var Counter = AV.Object.extend("Counter");
	url = $(".leancloud_visitors").attr('id').trim();
	title = $(".leancloud_visitors").attr('data-flag-title').trim();
	var query = new AV.Query(Counter);
	query.equalTo("url", url);
	query.find({
		success: function(results) {
			if (results.length > 0) {
				var counter = results[0];
				counter.fetchWhenSave(true);
				counter.increment("time");
				counter.save(null, {
					success: function(counter) {
						var content = counter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(counter, error) {
						console.log('Failed to save Visitor num, with error message: ' + error.message);
					}
				});
			} else {
				var newcounter = new Counter();
				newcounter.set("title", title);
				newcounter.set("url", url);
				newcounter.set("time", 1);
				newcounter.save(null, {
					success: function(newcounter) {
					    console.log("newcounter.get('time')="+newcounter.get('time'));
						var content = newcounter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(newcounter, error) {
						console.log('Failed to create');
					}
				});
			}
		},
		error: function(error) {
			console.log('Error:' + error.code + " " + error.message);
		}
	});
}
$(function() {
	var Counter = AV.Object.extend("Counter");
	if ($('.leancloud_visitors').length == 1) {
		addCount(Counter);
	} else {
		showTime(Counter);
	}
}); 
</script>



   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'SbGHqy6xigse8A1P9rctla9N-gzGzoHsz',
    appKey: 'Yjv3BxtjwA5IStDccnVj1eQr',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>